import { getVotePresets } from '../vote-presets'
import { encodeCallScript } from '../voting-scripts'
const wagmi = require('@wagmi/core')

describe('migrateTreasuryFunds', () => {
  test('Should match the generated script', async () => {
    jest.spyOn(wagmi, 'readContract').mockReturnValue(18)
    const presets = getVotePresets({
      presetParams: {
        0: '0xf4ea6b892853413bd9d9f1a5d3a620a0ba39c5b2',
        1: 100,
        2: '0x00f1918e',
        3: '0xf1f6568a76559d85cF68E6597fA587544184dD46'
      },
      setPresetParams: () => null,
      provider: () => null
    })
    const preset = presets['migrateTreasuryFunds']
    const actions = await preset.prepare()
    const script = encodeCallScript(actions)

    const expectedScript =
      '0x00000001dd92eb1478d3189707ab7f4a5ace3a615cdd047600000064beabacc8000000000000000000000000f4ea6b892853413bd9d9f1a5d3a620a0ba39c5b20000000000000000000000002211bfd97b1c02ae8ac305d206e9780ba7d8bff40000000000000000000000000000000000000000000000056bc75e2d63100000f4ea6b892853413bd9d9f1a5d3a620a0ba39c5b200000044095ea7b3000000000000000000000000e396757ec7e6ac7c8e5abe7285dde47b98f22db80000000000000000000000000000000000000000000000056bc75e2d63100000e396757ec7e6ac7c8e5abe7285dde47b98f22db800000124c322525d0000000000000000000000000000000000000000000000056bc75e2d63100000000000000000000000000000f4ea6b892853413bd9d9f1a5d3a620a0ba39c5b200000000000000000000000000000000000000000000000000000000000000a0000000000000000000000000000000000000000000000000000000000000010000f1918e00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000002a307866316636353638613736353539643835634636384536353937664135383735343431383464443436000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000'

    expect(script).toStrictEqual(expectedScript)
  })
})
